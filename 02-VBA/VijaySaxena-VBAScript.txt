Sub TickerWb()    'This is implemented for "Process all worksheets in a workbook -Challange"    Dim ws As Worksheet    Dim active_ws As Worksheet        'remember current (active) worksheet    Set active_ws = ActiveSheet    'loop thru all worksheets    For Each ws In ThisWorkbook.Worksheets        ws.Activate        TickerSummary ws    Next    're-activate the previously active worksheet    active_ws.ActivateEnd SubSub TickerSummary(ws As Worksheet)    'MsgBox ("Processing "+ws.Name)    'declare variables    Dim currentRow As Long    Dim tkrSummaryRow As Long    Dim tkrTotalVolume As Double    Dim tkrVolumeCol As Integer    Dim tkrSummaryCol As Integer    Dim prevTkr As String    Dim openingPriceCol As Integer    Dim closingPriceCol As Integer        Dim tkrOpeningPrice As Double    Dim tkrClosingPrice As Double        Dim maxVolume As Double    Dim tkrMaxVolume As String        Dim maxIncrease As Double    Dim tkrMaxIncrease As String        Dim maxDecrease As Double    Dim tkrMaxDecrease As String                ' Variable intialization    currentRow = 2    tkrSummaryRow = 1    prevTkr = ""    tkrTotalVolume = 0    tkrVolumeCol = 7    tkrSummaryCol = 10    tkrOpeningPrice = 0    tkrClosingPrice = 0    openingPriceCol = 3    closingPriceCol = 6    prevTkr = Cells(currentRow, 1)    tkrOpeningPrice = Cells(currentRow, openingPriceCol)        tkrMaxVolume = Cells(currentRow, 1)    maxVolume = Cells(currentRow, tkrVolumeCol)          tkrMaxDecrease = Cells(currentRow, 1)     maxDecrease = Cells(currentRow, tkrSummaryCol + 2)          tkrMaxIncrease = Cells(currentRow, 1)     maxIncrease = Cells(currentRow, tkrSummaryCol + 2)         'define Column headers    Cells(tkrSummaryRow, tkrSummaryCol) = "Ticker"    Cells(tkrSummaryRow, tkrSummaryCol + 1) = "Yearly Change"    Cells(tkrSummaryRow, tkrSummaryCol + 2) = "Percentage Change"    Cells(tkrSummaryRow, tkrSummaryCol + 3) = "Total Stock Volume"    Cells(1, tkrSummaryCol + 7) = "Ticker"    Cells(1, tkrSummaryCol + 8) = "Value"    Cells(2, tkrSummaryCol + 6) = "Greatest % Increase"    Cells(3, tkrSummaryCol + 6) = "Greatest % Decrease"    Cells(4, tkrSummaryCol + 6) = "Greatest Total Volume"    ' loop to process all rows in the worksheet    Do While Cells(currentRow, 1) <> ""        If Cells(currentRow, 1) = prevTkr Then            tkrTotalVolume = tkrTotalVolume + Cells(currentRow, tkrVolumeCol)                    Else             'print previous total            tkrSummaryRow = tkrSummaryRow + 1            Cells(tkrSummaryRow, tkrSummaryCol) = prevTkr            Cells(tkrSummaryRow, tkrSummaryCol + 3) = tkrTotalVolume            tkrClosingPrice = Cells(currentRow - 1, closingPriceCol)                        'diagnostic columns            'Cells(tkrSummaryRow, tkrSummaryCol + 4) = tkrOpeningPrice            'Cells(tkrSummaryRow, tkrSummaryCol + 5) = tkrClosingPrice                        Cells(tkrSummaryRow, tkrSummaryCol + 1) = tkrClosingPrice - tkrOpeningPrice                        'preventing division by zero            If (tkrOpeningPrice = 0) Then                Cells(tkrSummaryRow, tkrSummaryCol + 2) = 0            Else                Cells(tkrSummaryRow, tkrSummaryCol + 2) = ((tkrClosingPrice - tkrOpeningPrice) / tkrOpeningPrice)            End If                        Cells(tkrSummaryRow, tkrSummaryCol + 2).NumberFormat = "0.00%"                        'change color based on opening-price vs closing-price            If (tkrClosingPrice > tkrOpeningPrice) Then                Cells(tkrSummaryRow, tkrSummaryCol + 1).Interior.ColorIndex = 4                            ElseIf (tkrClosingPrice < tkrOpeningPrice) Then                Cells(tkrSummaryRow, tkrSummaryCol + 1).Interior.ColorIndex = 3                            End If                          'reset Ticker volume total and prevTkr value             tkrTotalVolume = Cells(currentRow, tkrVolumeCol)                          tkrOpeningPrice = Cells(currentRow, openingPriceCol)                         prevTkr = Cells(currentRow, 1)        End If        currentRow = currentRow + 1    Loop        'print summary for last Ticker    tkrSummaryRow = tkrSummaryRow + 1    Cells(tkrSummaryRow, tkrSummaryCol) = prevTkr    Cells(tkrSummaryRow, tkrSummaryCol + 3) = tkrTotalVolume    tkrClosingPrice = Cells(currentRow - 1, closingPriceCol)    Cells(tkrSummaryRow, tkrSummaryCol + 1) = tkrClosingPrice - tkrOpeningPrice    'preventing division by zero    If (tkrOpeningPrice = 0) Then         Cells(tkrSummaryRow, tkrSummaryCol + 2) = 0     Else        Cells(tkrSummaryRow, tkrSummaryCol + 2) = ((tkrClosingPrice - tkrOpeningPrice) / tkrOpeningPrice)    End If        Cells(tkrSummaryRow, tkrSummaryCol + 2).NumberFormat = "0.00%"    If (tkrClosingPrice > tkrOpeningPrice) Then        Cells(tkrSummaryRow, tkrSummaryCol + 1).Interior.ColorIndex = 4                    ElseIf (tkrClosingPrice < tkrOpeningPrice) Then        Cells(tkrSummaryRow, tkrSummaryCol + 1).Interior.ColorIndex = 3                    End If        'Solution for Hard    currentRow = 2        Do While Cells(currentRow, tkrSummaryCol) <> ""        If Cells(currentRow, tkrSummaryCol + 2) > maxIncrease Then            tkrMaxIncrease = Cells(currentRow, tkrSummaryCol)            maxIncrease = Cells(currentRow, tkrSummaryCol + 2)                    End If                If Cells(currentRow, tkrSummaryCol + 2) < maxDecrease Then            tkrMaxDecrease = Cells(currentRow, tkrSummaryCol)            maxDecrease = Cells(currentRow, tkrSummaryCol + 2)                    End If                If Cells(currentRow, tkrSummaryCol + 3) > maxVolume Then            tkrMaxVolume = Cells(currentRow, tkrSummaryCol)            maxVolume = Cells(currentRow, tkrSummaryCol + 3)                    End If        currentRow = currentRow + 1    Loop        'MsgBox (WorksheetFunction.Max(Range("K:K")))    Cells(2, tkrSummaryCol + 7) = tkrMaxIncrease    Cells(3, tkrSummaryCol + 7) = tkrMaxDecrease    Cells(4, tkrSummaryCol + 7) = tkrMaxVolume         Cells(2, tkrSummaryCol + 8) = maxIncrease     Cells(2, tkrSummaryCol + 8).NumberFormat = "0.00%"     Cells(3, tkrSummaryCol + 8) = maxDecrease     Cells(3, tkrSummaryCol + 8).NumberFormat = "0.00%"     Cells(4, tkrSummaryCol + 8) = maxVolumeEnd Sub